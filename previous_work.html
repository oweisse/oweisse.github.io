<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, shrink-to-fit=no, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Ofir Weisse</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/simple-sidebar.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

        <!-- Sidebar -->
        <div id="sidebar-wrapper">
            <ul class="sidebar-nav">
                <li>
                        <div id="profilepic">
                            <img src="headshot.png" />
                        </div>
                </li>
                <li class="sidebar-brand">
                    <a href="index.html">
                        Home
                    </a>
                </li>
                <li>
                    <a href="previous_work.html">Academic Work</a>
                </li>
                <li>
                    <a href="open_source_projects.html">Open Source Projects</a>
                </li>
                <!-- <li>
                    <a href="#">Shortcuts</a>
                </li>
                <li>
                    <a href="#">Overview</a>
                </li>
                <li>
                    <a href="#">Events</a>
                </li>
                <li>
                    <a href="#">About</a>
                </li>
                <li>
                    <a href="#">Services</a>
                </li>
                <li>
                    <a href="#">Contact</a>
                </li> -->
            </ul>
        </div>
        <!-- /#sidebar-wrapper -->

        <!-- Page Content -->
        <div id="page-content-wrapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12">
                      <h1>Academic Work</h1>
                      <p>
                      <a href="index.html">
                          Home
                      </a>
                    </p>


<h2>NDA: Preventing Speculative Execution Attacks at Their Source</h2>
<h3>Accepted for publication at MICRO 2019. <a href="MICRO2019_NDA.pdf"> The paper.</a>
       <a href="#bibtex" class="btn btn-default fs-btn" data-toggle="collapse" role="button">
            Cite <i class="fa fa-quote-right" aria-hidden="true"></i></a>

            </h3>
    <div id="bibtex" class="container collapse">
<pre style="white-space: pre">
@inproceedings{weisse2019nda,
  title={{NDA: Preventing Speculative Execution Attacks at Their Source}},
  author={Weisse, Ofir and Neal, Ian and Loughlin, Kevin and Wenisch, Thomas and Kasikci, Baris},
  booktitle={Proceedings of the 52nd IEEE/ACM International Symposium on Microarchitecture},
  year={2019},
  month={October},
  organization={IEEE/ACM}
}
</pre>
    </div> 

<p><b>Abstract:</b> 
Speculative execution attacks like Meltdown and Spectre work by accessing secret data in wrong-path execution. Secrets are then transmitted and recovered by the attacker via a covert channel. Existing mitigations either require code modifications, address only specific exploit techniques, or block only the cache covert channel. Rather than battling exploit techniques and covert channels one by one, we seek to close off speculative execution attacks at their source. Our key observation is that these attacks require a chain of dependent wrong-path instructions to access and transmit secret data. We propose NDA, a technique to restrict speculative data propagation. NDA breaks the wrong-path dependence chains required by all known attacks, while still allowing speculation and dynamic scheduling. We describe a design space of NDA variants that differ in the constraints they place on the dynamic scheduling and the classes of speculative execution attacks they prevent. NDA preserves much of the performance advantage of out-of-order execution: on SPEC CPU 2017, NDA variants close 68-96% of the performance gap between in-order and unconstrained (insecure) out-of-order execution.
 </p>


<iframe width="853" height="480" src="https://www.youtube.com/embed/sIfcnJUcZ6I" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        
<h2>Foreshadow: Extracting the Keys to the Intel SGX Kingdom with Transient Out-of-Order Execution</h2>
                                                <h3> Appeared at <a href="https://www.usenix.org/conference/usenixsecurity18/technical-sessions"> USENIX Security 2018</a>
                                                <h3> Attack website: <a href="https://ForeshadowAttack.com"> ForeshadowAttack.com</a></h3>
                                                <iframe width="560" height="315" src="https://www.youtube.com/embed/ynB1inl4G3c?rel=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>                         

                                                <br/>
                                                <h3>Talk at Duo Security in Ann Arbor</h3>
                                                <iframe width="560" height="315" src="https://www.youtube.com/embed/LVeWUq_mciM" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                                                <br/>

                                                <br/>
                                                <h3>Talk at UCB</h3>
                                                <iframe width="560" height="315" src="https://www.youtube.com/embed/EahQBMuhx5Y" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
                                                <br/>
                                                <h3>Demo at USENIX Security</h3>
                                                <iframe width="560" height="315" src="https://www.youtube.com/embed/fEV6eA9o21o?start=730" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                                <br/>
                                                In the news: <a href="https://arstechnica.com/gadgets/2018/08/intels-sgx-blown-wide-open-by-you-guessed-it-a-speculative-execution-attack/">ars Technica</a>, 
<a href="https://www.theregister.co.uk/2018/08/15/foreshadow_sgx_software_attestations_collateral_damage/">The Register</a>, 
<a href="https://www.wired.com/story/foreshadow-intel-secure-enclave-vulnerability/">Wired</a>, 
<a href="https://www.bbc.com/news/technology-45191697">BBC</a>, 
<a href="https://wiki.ubuntu.com/SecurityTeam/KnowledgeBase/L1TF">Ubuntu Wiki</a>, 
<a href="https://thehackernews.com/2018/08/foreshadow-intel-processor-vulnerability.html">The Hacker News</a>, 
<a href="https://en.wikipedia.org/wiki/Foreshadow_(security_vulnerability)">Wikipedia</a>, 
<a href="https://www.pcworld.com/article/3297419/security/foreshadow-l1tf-is-a-speculative-execution-exploit-targeting-intel-core-chips.html">PC World</a>, 
<a href="https://www.zdnet.com/article/beyond-spectre-foreshadow-a-new-intel-security-problem/">ZDNet</a> 

                                                </h3>


                                                <p>

                                                
<p><b>Abstract:</b> 
Trusted execution environments, and particularly the Software Guard eXtensions
(SGX) included in recent Intel x86 processors, gained significant traction
in recent years.
A long track of research papers, and increasingly also real-world industry
applications, take advantage of the strong hardware-enforced confidentiality
and integrity guarantees provided by Intel SGX.
Ultimately, enclaved execution
holds the compelling potential of
securely offloading sensitive computations to untrusted remote platforms.

We present Foreshadow, a practical software-only microarchitectural attack
that decisively dismantles the
security objectives of current SGX implementations.
Crucially, unlike previous SGX attacks,
we do not make any assumptions on the victim enclave's code and
do not necessarily require kernel-level access.
At its core, Foreshadow abuses a speculative execution bug in
modern Intel processors, on top of which we develop a novel exploitation
methodology to reliably leak plaintext enclave secrets from the
CPU cache.
We demonstrate
our attacks by extracting full
cryptographic keys from Intel's vetted architectural enclaves, and
validate their correctness by launching rogue production enclaves and
forging arbitrary local and remote attestation responses.
The extracted remote attestation keys affect millions of devices.
 </p>
        

		
<h2> Regaining Lost Cycles with HotCalls: A Fast Interface for SGX Secure Enclaves</h2>

												<h3> Published at <a href="http://isca17.ece.utoronto.ca/doku.php"> ISCA 2017</a></h3> <h3><a href="ISCA17_Ofir_Weisse.pdf"> The paper,</a> <a href="https://github.com/oweisse/hot-calls"> Git repo</a>, <a href="https://www.youtube.com/watch?v=I3TCctdnOEc&feature=youtu.be"> Linux Kernel Meetup Talk (Hebrew)</a>, <a href="https://www.slideshare.net/kerneltlv/sgx-trusted-execution-environment"> Slides</a></h3><p>
												
<p><b>Abstract:</b> Intel's SGX secure execution technology allows the running of computations on secret data using untrusted cloud servers. While recent work showed how to port applications and large scale computations to run under SGX, the performance implications of using the technology remains an open question. We present the first comprehensive quantitative study to evaluate the performance of SGX. We show that straightforward use of SGX library primitives for calling functions add between 8,200 - 17,000 cycles overhead, compared to 150 cycles of a typical system call. We quantify the performance impact of these library calls and show that in applications with high system calls frequency, such as <i>memcached</i>, <i>openVPN</i>, and <i>lighttpd</i>, which all have high bandwidth network requirements, the performance degradation may be as high as 79%. We  investigate the sources of this performance degradation by leveraging a new set of micro-benchmarks for SGX-specific operations such as entry-calls and out-calls, and encrypted memory I/O accesses. We leverage the insights we gain from these analyses to design a new SGX interface framework, <i>HotCalls</i>: <i>HotCalls</i> provide a 13-27x speedup over the default interface. It can easily be integrated into existing code, making it a practical solution. Compared to a baseline SGX  implementation of <i>memcached</i>, <i>openVPN</i>,  and <i>lighttpd</i>  - we  show that using the new interface  boosts the throughput by 2.6-3.7x, and reduce application response time by 62-74%. </p>
		
		<h2> WALNUT: Waging doubt on integrity of MEMS AcceLerometers by iNjecting acoUsTics</h2>
												<h3> Published at <a href="http://www.ieee-security.org/TC/EuroSP2017/"> IEEE European Symposium on Security and Privacy, 2017</a> 
                                                <h3><a href="trippel-IEEE-oaklawn-walnut-2017.pdf"> The paper,</a> <a href="https://spqr.eecs.umich.edu/walnut/"> paper-website</a>
                                                <br/>
                                                Additional links: 
                                                <a href="https://ics-cert.us-cert.gov/alerts/ICS-ALERT-17-073-01"> ICS-ALERT,</a>
                                                <a href="https://www.nytimes.com/2017/03/14/technology/phone-hacking-sound-waves.html?_r=0"> The New York Times,</a>  

                                                <a href="http://www.engin.umich.edu/college/about/news/stories/2017/march/sonic-cyber-attack-shows-security-holes-in-ubiquitous-sensors"> Michigan Engineering,</a>

                                                <a href="http://fortune.com/2017/03/14/hack-fitbit-smart-phones-using-sound/"> Fortune,</a>

                                                 <a href=" http://gizmodo.com/hackers-can-now-use-sound-waves-to-take-control-of-your-1793259066"> Gizmodo.</a>

                                                

                                                

                                                </h3>

                                                <p>
												
<p><b>Abstract:</b> Embedded systems depend on sensors to make automated decisions.  Resonant acoustic injection attacks are already known to cause malfunctions by disabling MEMS-based gyroscopes. However, an open question remains on how to move beyond denial of service attacks to achieve full adversarial control of sensor outputs.  Our work investigates how analog acoustic injection attacks can damage the digital <i> integrity</i>  of a popular type of sensor  in consumer devices: the capacitive MEMS accelerometer. Spoofing such sensors with intentional acoustic interference enables an out-of-spec pathway for attackers to deliver chosen digital values to microprocessors and embedded systems that blindly trust the unvalidated integrity of sensor outputs. Our contributions include (1) modeling the physics of malicious acoustic interference on MEMS
accelerometers, (2) discovering the circuit-level design flaws that cause the vulnerabilities by  measuring acoustic injection attacks on MEMS accelerometers as well as systems that depend on the sensors, and (3) two software-only defenses that mitigate many of the risks to the integrity of MEMS accelerometer outputs.
<br/><br/>
We characterize two classes of acoustic injection attacks: <i>output biasing </i> and <i>output control</i>. We test these attacks against 20 models of capacitive MEMS accelerometers representing the majority of the consumer market. Our experiments find that 75\% are vulnerable to output biasing, and 65\% are vulnerable to total output control. To illustrate end-to-end implications, we show how to inject fake steps into a Fitbit with a $5 speaker. In our <i>self-stimulating attack</i>, we play a malicious music file from a smartphone's speaker to control the on-board MEMS accelerometer trusted by a local app to pilot a toy RC car. In addition to offering hardware design fixes to eliminate the root causes of poor amplification and filtering, we introduce two low-cost defenses that mitigate output biasing attacks: <i>randomized sampling</i> and <i>180<sup>o</sup> out-of-phase sampling</i>. These software-only approaches mitigate attacks by exploiting the periodic and predictable nature of the malicious acoustic interference signal. Our results call into question the wisdom of allowing microprocessors and embedded systems to blindly trust that hardware abstractions alone will ensure the integrity of sensor outputs.
</p>
					
                        <h2> A New Framework for Constraint-Based Probabilistic Template Side Channel Attacks</h2>

												<h3> Published in CHES 2014, The major part of the Master's Thesis. <a href="CHES2014_oww.pdf">Link</a></h3> <p>
												<br/>The implementation was submitted to the <a href="http://www.dpacontest.org/v4">DPA v4 contest</a>
												<br/>
												<br/><a href="http://prezi.com/-k7ui4_2bbn_/?utm_campaign=share&utm_medium=copy&rc=ex0share">CHES presentation</a>
												<br/><a href="ches-2014-OrenWeisseWool.zip">CHES presentation - offline version</a> (Zip file contains the Prezi executable, and is therefore encrypted. Passowrd: 12345678. )

												<br/>
											</p>
                        <p><b>Abstract:</b> The use of constraint solvers, such as SAT- or PseudoBoolean-solvers, allows the extraction of the secret key from one or two side-channel traces. However, to use such a solver the cipher must be represented at bit-level. For byte-oriented ciphers this produces very large and unwieldy instances, leading to unpredictable, and often very long, run times. In this paper we describe a specialized byte-oriented constraint solver for side channel cryptanalysis. The user only needs to supply code snippets for the native operations of the cipher, arranged in a flow graph that models the dependence between the side channel leaks. Our framework uses a soft decision mechanism which overcomes realistic measurement noise and decoder classification errors, through a novel method for reconciling multiple probability distributions. On the DPA v4 contest dataset our framework is able to extract the correct key from one or two power traces in under 9 seconds with a success rate of over 79%.'
</p>
												<h2> Practical Template-Algebraic Side Channel Attacks with Extremely Low Data Complexity </h2>
                        <h3> Published in HASP 2013 <a href="OrenWeisseWool-TemplateAlgebraic-HASP2013.pdf"> Link </a></h3>

												<p> <b>Abstract:</b> Template-based Tolerant Algebraic Side Channel Attacks (Template-TASCA) were suggested in [20] as a way of reducing the high data complexity of template attacks by coupling them with algebraic side-channel attacks. In contrast to the maximum-likelihood method used in a standard template attack, the template-algebraic attack method uses a constraint solver to find the optimal state correlated to the measured side-channel leakage. In this work we present the first application of the template-algebraic key recovery attack to a publicly available data set (IAIK WS2). We show how our attack can successfully recover the encryption key even when the attacker has extremely limited access to the device under test \xe2\x80\x93 only 200 traces in the offline phase and as little as a single trace in the online phase.'
												</p>

												<h2>DPA v4 Contest Submission</h2>
												<p>
												Source code of the contest candidate. Includes the constraint solver described in CHES 2014, and decoders that were  described in the HASP 2013 work </p>
                        <p>Source: <a href="https://github.com/oweisse/dpav4-contest">https://github.com/oweisse/dpav4-contest</a>
                        <br/>
                        <a href="DPA_v4_source_v003.zip">source code zip</a>.
                      </p>
                        <h2>New Methods for Side Channel Cryptanalysis
                        </h2>
                        <h3> Master's Thesis, 2014 <a href="ofir_weisse_msc_thesis.pdf">Link</a> </h3>
                        <p> <b>Abstract:</b>
                        Template-based Tolerant Algebraic Side Channel Attacks (Template-TASCA) were sug- gested by Wool et al. in 2012. as a way of reducing the high data complexity of template attacks by coupling them with algebraic side-channel attacks. In contrast to the maximum-likelihood method used in a standard template attack, the template- algebraic attack method uses a constraint solver to find the optimal state correlated to the measured side-channel leakage. In this work we present a practical application of the template-algebraic key recovery attack to a publicly available data set (IAIK WS2). We show how our attack can successfully recover the encryption key even when the attacker has extremely limited access to the device under test – only 200 traces in the offline phase and as little as a single trace in the online phase. However, to use such solvers the cipher must be represented at bit-level. For byte-oriented ciphers this pro- duces very large and unwieldy instances, leading to unpredictable, and often very long, run times. In this work we describe a specialized byte-oriented constraint solver for side channel cryptanalysis. The user only needs to supply code snippets for the native operations of the cipher, arranged in a flow graph that models the dependence between the side channel leaks. Our framework uses a soft decision mechanism which overcomes realistic measurement noise and decoder classification errors, through a novel method for reconciling multiple probability distributions. On the DPA v4 contest dataset our framework is able to extract the correct key from one or two power traces in under 9 seconds with a success rate of over 79%. </p>

                        <a href="#menu-toggle" class="btn btn-default" id="menu-toggle">Toggle Menu</a>
                    </div>
                </div>
            </div>
        </div>
        <!-- /#page-content-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55464074-1', 'auto');
  ga('send', 'pageview');

</script>
    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Menu Toggle Script -->
    <script>
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
    </script>

</body>

</html>
